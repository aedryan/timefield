(function($){$.fn.timefield=function(){var date=new Date,ihours=date.getHours(),ushours=ihours>12?ihours-=12:ihours;$(this).append($("<div></div>").addClass("tc-container").append($("<input>").attr({maxlength:2,placeholder:"00",value:("0"+ushours).slice(-2)}).addClass("tc-hours tc-numbers")).append("<span>:</span>").append($("<input />").attr({maxlength:2,placeholder:"00",value:("0"+date.getMinutes()).slice(-2)}).addClass("tc-minutes tc-numbers")).append("<span>:</span>").append($("<input>").attr({maxlength:2,placeholder:"00",value:("0"+date.getSeconds()).slice(-2)}).addClass("tc-seconds tc-numbers")).append($("<input>").attr({maxlength:2,placeholder:"AM",value:date.getHours().valueOf()>12?"PM":"AM"}).addClass("tc-ampm")));$(".tc-container").css({"border":"1px solid rgb(200,200,200)","background-color":"white","box-shadow":"inset 0 1px 2px rgba(0,0,0,.1)","padding":"1px","display":"inline-block"});$(".tc-container input").css({"border":"none","background":"none","width":"20px","padding":"0px","margin":"0px","text-align":"center","font-size":"0.8em","display":"inline-block","cursor":"default","outline":"0"});$(".tc-ampm").css({"width":"25px"});$(".tc-AMPM").on("keydown",function(e){switch(e.keyCode){case 65:$(this).val("AM");break;case 80:$(this).val("PM");break}});$(".tc-container input").on("click",function(){$(this).select()});$(".tc-numbers").on("keypress",function(evt){var charCode=evt.which?evt.which:event.keyCode;if(charCode>31&&(charCode<48||charCode>57))return false;else return true});var OGminute=$(".tc-minutes").clone().val();var OGhour=$(".tc-hours").clone().val();var OGsecond=$(".tc-seconds").clone().val();var checkFields=function(expected,og,element,value){if(value>expected){$(element).effect("highlight",{color:"rgba(255,180,180)",complete:function(){$(element).select()}},500);$(".tc-container").effect("shake",{distance:3,times:2},250);$(element).val(og)}else og=value};$(".tc-seconds").keyup(function(){checkFields(60,OGsecond,$(this),$(this).val())});$(".tc-minutes").keyup(function(){checkFields(60,OGminute,$(this),$(this).val())});$(".tc-hours").keyup(function(){checkFields(12,OGhour,$(this),$(this).val())});$(".tc-numbers").on("blur",function(){$(this).val(function(i,txt){return txt.replace(/^\d$/,"0$&")})});$(".tc-numbers").on("focus",function(){var oldVal=$(this).val(),inputs=$(".tc-container input");$(this).on("keyup",function(){if($(this).val()!=oldVal&&$(this).val().length==2){inputs[inputs.index(this)+1].select();oldVal=$(this).val()}})})}})(jQuery);
